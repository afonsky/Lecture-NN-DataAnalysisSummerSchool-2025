---
zoom: 0.9
---

# Однослойные нейронные сети

<div class="grid grid-cols-[5fr_2fr]">
<div>

Нейронная сеть принимает на вход вектор переменных $p$ $X = (X_1, X_2, ..., X_p)$ и строит нелинейную функцию $f(X)$ для предсказания ответа $Y$:
* $f(X) = \beta_0 + \sum\limits_{k=1}^K \beta_k A_k$<br>
* Признаки $X_1, X_2, ..., X_p$ - нейроны во **входном слое**
* $K$ **скрытых нейронов** образуют **скрытый слой**
* $A_k$ **активации** вычисляются как функции входных признаков:<br>
$A_k = g(w_{k0} + \sum\limits_{j=1}^p w_{kj}X_j)$,<br>
  * $A_k(X)$ это преобразование исходных признаков<br>
  * $g(z)$ нелинейная **функция активации**, задаваемая заранее
* Наконец, $f(X) = \beta_0 + \sum\limits_{k=1}^K \beta_k g(w_{k0} + \sum\limits_{j=1}^p w_{kj}X_j)$
</div>
<div>
  <figure>
    <img src="/ISLRv2_figure_10.1.png" style="width: 250px !important;">
    <figcaption style="color:#b3b3b3ff; font-size: 10px; position: absolute;"><br>Полносвязная нейронная сеть<br>Источник изображения:
      <a href="https://www.statlearning.com/">ISLP Рис. 10.1</a>
    </figcaption>
  </figure>
</div>
</div>

---
zoom: 0.9
---

# Распространенные функции активации

<div class="grid grid-cols-[3fr_2fr]">
<div>

* <span style="color:#1f77b4">Sigmoid</span> (Логистическая): $\sigma(z) := \frac{1}{1 + e^{-z}}$
* <span style="color:#2ca02c">tanh</span> (Гиперболический тангенс): $\mathrm{tanh}(z) := \frac{e^z - e^{-z}}{e^z + e^{-z}}$
* <span style="color:#d62728">ReLU</span>: $\mathrm{ReLU}(z):=\max(0,z)$
* <span style="color:#ff7f0e">Leaky ReLU</span>
* <span style="color:#e377c2">Softplus</span>: $\mathrm{softplus}(z):=\log(1+\exp(z))$

* Почему не использовать линейную активацию?<br> $\phi(x):= a + b' x$
  * ➕ Всюду дифференцируема, "*быстро*" вычисляется
  * ➖ Не вносит нелинейности. Линейная комбинация линейных комбинаций - это просто линейная комбинация. Несколько слоев с активацией $\phi$ могут быть сведены к одной линейной модели.

</div>
<div>
<v-plotly style="width: 400px !important; height: 400px !important"
:data="[
{
mode: 'lines',
name: 'Sigmoid',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [0.006693, 0.008044, 0.009664, 0.011607, 0.013936, 0.016724, 0.020058, 0.02404, 0.02879, 0.034445, 0.041164, 0.049127, 0.058537, 0.069617, 0.08261, 0.097773, 0.115369, 0.135656, 0.158869, 0.185204, 0.214789, 0.247664, 0.283752, 0.322842, 0.364576, 0.408452, 0.453836, 0.5, 0.546164, 0.591548, 0.635424, 0.677158, 0.716248, 0.752336, 0.785211, 0.814796, 0.841131, 0.864344, 0.884631, 0.902227, 0.91739, 0.930383, 0.941463, 0.950873, 0.958836, 0.965555, 0.97121, 0.97596, 0.979942, 0.983276, 0.986064, 0.988393, 0.990336, 0.991956, 0.993307],
line: {color: 'blue'},
visible: true,
showlegend: true
},
{
mode: 'lines',
name: 'tanh',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [-0.999909, -0.999869, -0.99981, -0.999724, -0.999601, -0.999422, -0.999162, -0.998787, -0.998244, -0.997458, -0.996321, -0.994676, -0.992298, -0.988865, -0.983913, -0.976785, -0.966553, -0.95192, -0.93111, -0.901745, -0.860767, -0.804455, -0.728689, -0.629592, -0.504672, -0.354316, -0.183097, 0, 0.183097, 0.354316, 0.504672, 0.629592, 0.728689, 0.804455, 0.860767, 0.901745, 0.93111, 0.95192, 0.966553, 0.976785, 0.983913, 0.988865, 0.992298, 0.994676, 0.996321, 0.997458, 0.998244, 0.998787, 0.999162, 0.999422, 0.999601, 0.999724, 0.99981, 0.999869, 0.999909],
line: {color: 'green'},
visible: true, 
showlegend: true
},
{
mode: 'lines',
name: 'ReLU',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
line: {color: '#d62728'},
visible: true, 
showlegend: true
},
{
mode: 'lines',
name: 'Leaky ReLU',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [-0.54, -0.52, -0.5, -0.48, -0.46, -0.44, -0.42, -0.4, -0.38, -0.36, -0.34, -0.32, -0.3, -0.28, -0.26, -0.24, -0.22, -0.2, -0.18, -0.16, -0.14, -0.12, -0.1, -0.08, -0.06, -0.04, -0.02, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
line: {color: 'orange'},
visible: true, 
showlegend: true
},
{
mode: 'lines',
name: 'Softplus',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [0.006715348489117967, 0.008076023012089954, 0.009711063647891118, 0.011675212366013028, 0.014033834382744555, 0.01686494078726026, 0.020261417565356637, 0.024333640770363863, 0.02921243586415027, 0.03505242756119688, 0.04203555789335591, 0.050375197782887154, 0.06032011447535636, 0.07215856947387311, 0.08622217950439137, 0.10288870582472144, 0.12258443031122099, 0.14578397571374793, 0.1730079359294782, 0.20481729174645305, 0.24180287636510978, 0.2845720095044729, 0.3337287631202068, 0.3898508408175414, 0.45346331796198625, 0.5250118060922152, 0.604835254831138, 0.6931471805599453, 0.790020254831138, 0.8953818060922152, 1.0090193179619864, 1.1305918408175413, 1.2596547631202069, 1.395683009504473, 1.5380988763651096, 1.686298291746453, 1.8396749359294782, 1.9976359757137478, 2.1596214303112213, 2.3251107058247213, 2.4936291795043917, 2.664751569473873, 2.8380981144753568, 3.013338197782887, 3.190183557893356, 3.368385427561197, 3.54773143586415, 3.728037640770364, 3.9091504175653564, 4.090938940787261, 4.273292834382745, 4.456119212366013, 4.6393410636478905, 4.82289102301209, 5.006715348489118],
line: {color: 'pink'},
visible: true, 
showlegend: true
},
{
mode: 'lines',
name: 'Linear',
type: 'scatter',
x: [-5, -4.814815, -4.62963, -4.444444, -4.259259, -4.074074, -3.888889, -3.703704, -3.518519, -3.333333, -3.148148, -2.962963, -2.777778, -2.592593, -2.407407, -2.222222, -2.037037, -1.851852, -1.666667, -1.481481, -1.296296, -1.111111, -0.925926, -0.740741, -0.555556, -0.37037, -0.185185, 0, 0.185185, 0.37037, 0.555556, 0.740741, 0.925926, 1.111111, 1.296296, 1.481481, 1.666667, 1.851852, 2.037037, 2.222222, 2.407407, 2.592593, 2.777778, 2.962963, 3.148148, 3.333333, 3.518519, 3.703704, 3.888889, 4.074074, 4.259259, 4.444444, 4.62963, 4.814815, 5],
y: [-2.0, -1.9074075000000001, -1.8148149999999998, -1.722222, -1.6296295, -1.5370370000000002, -1.4444445, -1.351852, -1.2592595, -1.1666665, -1.074074, -0.9814814999999999, -0.888889, -0.7962965, -0.7037035, -0.611111, -0.5185185000000001, -0.425926, -0.33333349999999995, -0.24074050000000002, -0.14814799999999995, -0.05555549999999998, 0.03703699999999999, 0.1296295, 0.22222199999999998, 0.314815, 0.40740750000000003, 0.5, 0.5925925, 0.6851849999999999, 0.7777780000000001, 0.8703704999999999, 0.962963, 1.0555555, 1.148148, 1.2407405, 1.3333335, 1.425926, 1.5185185, 1.611111, 1.7037035, 1.7962965, 1.888889, 1.9814815, 2.074074, 2.1666665, 2.2592594999999998, 2.351852, 2.4444445, 2.537037, 2.6296295, 2.722222, 2.814815, 2.9074075, 3.0]
,
line: {color: 'black'},
visible: true, 
showlegend: true
}]"
:layout="{
xaxis: {title: 'z'},
yaxis: {title: 'g(z)'},
margin: {l: 40, r:0, b:70, t:20, pad: 2},
legend: {x:0.1, y: 0.9}
}"
:config="{displayModeBar: true}"
:options="{}"/>
</div>
</div>

---
zoom: 0.93
---

# Пример

#### Предположим, что у нас есть $p = 2$ входных переменных $X = (X_1, X_2)$<br> и $K = 2$ скрытых нейронов.

<div class="grid grid-cols-[5fr_3fr]">
<div>


Найдем $f(X)$, если активация $g(z) = z^2$ и

$\beta_0 = 0, \beta_1 = \frac{1}{4}, \beta_2 = -\frac{1}{4},\\
w_{10} = 0, w_{11} = 1, w_{12} = 1,\\
w_{20} = 0, w_{21} = 1, w_{22} = -1.$

___

$A_k = g(w_{k0} + \sum\limits_{j=1}^p w_{kj}X_j)$<br>
$A_1 = (0 + X_1 + X_2)^2$; $~~~A_2 = (0 + X_1 - X_2)^2$

</div>
<div>
<br>
  <figure>
    <img src="/Simplest_NN.svg" style="width: 350px !important;">
  </figure>
<br>

Потери при квадратичной ошибке: $\sum\limits_{i=1}^n (y_i - f(x_i))^2$
</div>
</div>

$f(X) = \beta_0 + \sum\limits_{k=1}^K \beta_k A_k
= 0 + \frac{1}{4} \cdot (0 + X_1 + X_2)^2
-\frac{1}{4} \cdot (0 + X_1 - X_2)^2 =\\
= \frac{1}{4}[(X_1 + X_2)^2 - (X_1 - X_2)^2] = X_1 X_2$